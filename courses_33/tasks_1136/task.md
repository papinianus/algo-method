## 問題文

カメのアルルがアルバイトをしているお店では、データベースを用いて台帳を管理しています。 このお店ではある期間内に一定以上の金額の買い物をした「お得意様」にはさまざまな特典を付与するキャンペーンを行なっています。

アルルは、データベースから 2022 年 8 月 8 日から 8 月 14 日の 1 週間で 5,000 円以上の買い物をした「お得意様」を抽出する仕事を任されました。

---

顧客の購入履歴情報が格納されている ledger テーブルをもつデータベースが与えられます。 顧客ごとに 8 月 8 日から 8 月 14 日の間に購入した金額を集計し、「お得意様」の名前を表示するクエリを作成してください。

ただし、name カラムの名前は `顧客名` に変更し、期間内の合計購入金額を表すカラムの名前は `合計金額` として表示してください。

### ヒント 1. データを範囲で絞る

「500 円以上 1000 円以下の買い物」のように、データを範囲で搾る処理は `BETWEEN 〜 AND` を用いて実現することができます。 たとえば、500 円以上 1000 円以下の買い物データは次のようなクエリで求められます。
`SELECT * FROM ledger WHERE amount BETWEEN 500 AND 1000;`

### ヒント 2. 集計後に検索する

`GROUP BY` 句を用いて集計したデータに対して検索を行うには、`HAVING` 句を用います。

たとえば、購入回数が 10 回以上の顧客名と購入回数は次のクエリで求められます。

```sql
SELECT name, COUNT(*) AS '購入回数' FROM ledger GROUP BY name HAVING `購入回数` >= 10;
```

`WHERE` 句は集計前のデータの検索を行い、`HAVING` 句は集計後のデータの検索を行うことに注意してください。

## テーブル定義

| 物理名   | 型   | 必須? | 初期値 | 主キー? | 備考          |
| -------- | ---- | ----- | ------ | ------- | ------------- |
| id       | INT  | YES   | NULL   | YES     | id            |
| 一意制約 |      |       |        |         |               |
| name     | TEXT | NO    | NULL   | NO      | 購入者        |
| amount   | INT  | NO    | NULL   | NO      | 購入金額 (円) |
| date     | TEXT | NO    | NULL   | NO      | 日付          |

## データ例

| id  | name   | amount | date       |
| --- | ------ | ------ | ---------- |
| 1   | アルル | 860    | 2022-08-01 |
| 2   | アレレ | 1320   | 2022-08-01 |
| 3   | イリリ | 1100   | 2022-08-01 |
| 4   | エリリ | 1190   | 2022-08-01 |
| 5   | エルル | 870    | 2022-08-01 |
| 6   | エロロ | 800    | 2022-08-01 |
| 7   | イリリ | 1070   | 2022-08-02 |
| 8   | イレレ | 1370   | 2022-08-02 |
| 9   | ウリリ | 820    | 2022-08-02 |
| 10  | ウルル | 1020   | 2022-08-02 |
| 11  | ウルル | 1520   | 2022-08-02 |
| 12  | ウルル | 1270   | 2022-08-02 |
| 13  | ウレレ | 750    | 2022-08-02 |
| 14  | ウレレ | 770    | 2022-08-02 |
| 15  | ウレレ | 1080   | 2022-08-02 |
| 16  | エルル | 1020   | 2022-08-02 |
| 17  | エロロ | 990    | 2022-08-02 |
| 18  | エロロ | 780    | 2022-08-02 |
| 19  | オルル | 1150   | 2022-08-02 |
| 20  | アリリ | 820    | 2022-08-03 |
| 21  | アルル | 1310   | 2022-08-03 |
| 22  | イリリ | 700    | 2022-08-03 |
| 23  | イレレ | 1030   | 2022-08-03 |
| 24  | ウレレ | 1300   | 2022-08-03 |
| 25  | エララ | 1470   | 2022-08-03 |
| 26  | エリリ | 800    | 2022-08-03 |
| 27  | エロロ | 380    | 2022-08-03 |
| 28  | オリリ | 650    | 2022-08-03 |
| 29  | オルル | 790    | 2022-08-03 |
| 30  | オルル | 760    | 2022-08-03 |
| 31  | アレレ | 1100   | 2022-08-04 |
| 32  | アレレ | 1160   | 2022-08-04 |
| 33  | アロロ | 860    | 2022-08-04 |
| 34  | イロロ | 880    | 2022-08-04 |
| 35  | ウララ | 410    | 2022-08-04 |
| 36  | ウルル | 1690   | 2022-08-04 |
| 37  | ウレレ | 720    | 2022-08-04 |
| 38  | エリリ | 730    | 2022-08-04 |
| 39  | オリリ | 1070   | 2022-08-04 |
| 40  | アリリ | 940    | 2022-08-05 |
| 41  | アリリ | 920    | 2022-08-05 |
| 42  | イレレ | 1150   | 2022-08-05 |
| 43  | ウレレ | 930    | 2022-08-05 |
| 44  | オララ | 1220   | 2022-08-05 |
| 45  | オロロ | 950    | 2022-08-05 |
| 46  | アリリ | 1060   | 2022-08-06 |
| 47  | アレレ | 1040   | 2022-08-06 |
| 48  | ウリリ | 1070   | 2022-08-06 |
| 49  | オリリ | 1010   | 2022-08-06 |
| 50  | オリリ | 1090   | 2022-08-06 |
